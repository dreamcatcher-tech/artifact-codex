app = 'fly-agent-dev-suite'
primary_region = 'syd'

[build]
    dockerfile = 'agent-dev-suite/Dockerfile'

[env]
    # only set for the testing version
    DC_DOMAIN = 'agentic.dreamcatcher.land'
    DC_NFS = 'nfs-proto.flycast'
    DC_ROUTER = 'org1-fly-router.flycast'
    DC_EXEC = 'org1-fly-exec.flycast'
    DC_WORKER_POOL_APP = 'org1-worker-pool'
    DC_OPENAI_PROXY_BASE_URL = 'http://org1-openai-proxy.flycast'

[http_service]
    internal_port = 8080
    force_https = true
    auto_stop_machines = 'suspend'
    auto_start_machines = true
    min_machines_running = 0

[[services]]
    protocol = 'tcp'
    internal_port = 8080
    auto_stop_machines = 'suspend'
    auto_start_machines = true
    min_machines_running = 0

    [[services.ports]]
        start_port = 3000
        end_port = 30000
        handlers = ['tls', 'http']

[[vm]]
    memory = '1gb'
    cpu_kind = 'shared'
    cpus = 1

[deploy]
    release_command = '/app/agent-dev-suite/release.ts'

[experimental]
    lazy_load_images = true
